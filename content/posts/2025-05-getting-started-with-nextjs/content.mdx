## Next.js 15 èˆ‡ 14 ç‰ˆæœ¬çš„ä¸»è¦å·®ç•°

Next.js 15 åœ¨ 14 ç‰ˆæœ¬çš„åŸºç¤ä¸Šé€²è¡Œäº†å¤šé …é‡è¦æ”¹é€²å’ŒåŠŸèƒ½å¼·åŒ–ã€‚ä»¥ä¸‹æ˜¯ä¸»è¦å·®ç•°ï¼š

<VersionComparisonTable />


## Next.js 15 çš„é‡å¤§å„ªå‹¢èˆ‡æ–°ç‰¹æ€§

<Alert type="info" title="é‡è¦æ›´æ–°">
  Next.js 15 å·²ç¶“æ­£å¼ç™¼å¸ƒï¼Œå¸¶ä¾†äº†å¤šé …é‡è¦æ”¹é€²å’ŒåŠŸèƒ½å¼·åŒ–ã€‚å®ƒæ˜¯è‘—çœ¼æ–¼æ•ˆèƒ½å’Œé–‹ç™¼é«”é©—çš„é‡è¦ç‰ˆæœ¬ã€‚
</Alert>

Next.js 15 åœ¨åŸæœ‰ App Routerã€Server Componentsã€Edge Rendering ç­‰åŸºç¤ä¸Šï¼Œé€²ä¸€æ­¥å¼·åŒ–äº†é–‹ç™¼æ•ˆç‡ã€æ•ˆèƒ½èˆ‡ DXï¼ˆDeveloper Experienceï¼‰ã€‚ä¸»è¦äº®é»å¦‚ä¸‹ï¼š

### 1. ç©©å®šçš„ Partial Prerenderingï¼ˆPPRï¼‰

PPR æ˜¯ Next.js 15 æœ€é‡è¦çš„çªç ´ï¼Œå®ƒå…è¨±é é¢åŒæ™‚çµåˆéœæ…‹èˆ‡å‹•æ…‹å…§å®¹ï¼Œå¾æ ¹æœ¬ä¸Šæ”¹è®Šäº† Web æ‡‰ç”¨çš„æ¸²æŸ“æ–¹å¼ï¼š

- **éœæ…‹å¤–æ®¼å„ªå…ˆè¼‰å…¥**ï¼šé é¢çš„éœæ…‹éƒ¨åˆ†ï¼ˆå¦‚é é¢æ¡†æ¶ã€å°èˆªç­‰ï¼‰å³åˆ»å‘ˆç¾
- **å‹•æ…‹å€å¡Šå¹³è¡Œè™•ç†**ï¼šä½¿ç”¨è€…ä»‹é¢ä¸­çš„å‹•æ…‹å€åŸŸï¼ˆå¦‚å€‹äººåŒ–å…§å®¹ï¼‰é€šé Suspense é‚Šç•Œå¹³è¡Œè¼‰å…¥
- **å¢é‡éœæ…‹å†ç”Ÿï¼ˆISRï¼‰èˆ‡ PPR çµåˆ**ï¼šéœæ…‹å…§å®¹å¯è¨­å®šé‡æ–°é©—è­‰æ™‚é–“

èˆ‡ Next.js 14 çš„å¯¦é©—æ€§ PPR ç›¸æ¯”ï¼Œ15 ç‰ˆæœ¬çš„ PPR æä¾›ï¼š
- æ›´ç©©å®šçš„è¡Œç‚ºå’Œå¯é æ¸¬æ€§
- æ›´å®Œå–„çš„é–‹ç™¼è€…å·¥å…·æ”¯æ´
- èˆ‡ React 19 æ–°ç‰¹æ€§çš„æ·±åº¦æ•´åˆ

```tsx
// app/dashboard/page.tsx - Next.js 15 çš„ PPR ç¯„ä¾‹
import { Suspense } from 'react';
import StaticAnalytics from './StaticAnalytics';
import DynamicUserContent from './DynamicUserContent';

// é é¢çµåˆéœæ…‹èˆ‡å‹•æ…‹å…§å®¹
export default function Dashboard() {
  return (
    <main>
      {/* éœæ…‹å€åŸŸï¼šç«‹å³æ¸²æŸ“ */}
      <StaticAnalytics />
      
      {/* å‹•æ…‹å€åŸŸï¼šå¹³è¡Œè™•ç†ï¼Œä¸é˜»å¡éœæ…‹å…§å®¹ */}
      <Suspense fallback={<p>è¼‰å…¥å€‹äººåŒ–å…§å®¹ä¸­...</p>}>
        <DynamicUserContent />
      </Suspense>
    </main>
  );
}

// è¨­å®šéœæ…‹å¤–æ®¼çš„é‡æ–°é©—è­‰æ™‚é–“
export const revalidate = 3600; // 1å°æ™‚
```

### 2. Turbopack ç©©å®šç‰ˆ

Turbopack å¾ Beta éšæ®µé€²å…¥ç©©å®šç‰ˆï¼Œå–ä»£ Webpack æˆç‚º Next.js 15 çš„é è¨­æ‰“åŒ…å·¥å…·ï¼š

- **é–‹ç™¼å•Ÿå‹•é€Ÿåº¦æå‡ 5-10 å€**ï¼šç›¸æ¯” Next.js 14ï¼Œé–‹ç™¼ä¼ºæœå™¨å•Ÿå‹•é€Ÿåº¦å¤§å¹…æå‡
- **ç†±æ›´æ–°é€Ÿåº¦æå‡ 3-5 å€**ï¼šä»£ç¢¼ä¿®æ”¹åé¥‹æ›´å¿«ï¼Œé–‹ç™¼æµç¨‹æ›´é †æš¢
- **è¨˜æ†¶é«”ä½¿ç”¨æ•ˆç‡æå‡**ï¼šå¤§å‹å°ˆæ¡ˆè¨˜æ†¶é«”å ç”¨æ¸›å°‘ç´„ 40%
- **å®Œæ•´åŠŸèƒ½æ”¯æ´**ï¼šæ”¯æ´æ‰€æœ‰ Next.js ç‰¹æ€§ï¼ŒåŒ…æ‹¬è‡ªå®šç¾© webpack é…ç½®çš„å¹³æ»‘è½‰æ›

åœ¨ Next.js 14 ä¸­ï¼ŒTurbopack é‚„æœ‰ç›¸å®¹æ€§å•é¡Œï¼Œä½†åœ¨ 15 ç‰ˆæœ¬ä¸­å·²ç¶“å…¨éƒ¨è§£æ±ºã€‚

```bash
# Next.js 15 ä¸­é»˜èªå•Ÿç”¨ Turbopack
next dev

# å¦‚éœ€ç‰¹åˆ¥æŒ‡å®š
next dev --turbo
```

### 3. React 19 æ”¯æ´

Next.js 15 æ˜¯é¦–å€‹åŸç”Ÿæ•´åˆ React 19 çš„ä¸»æµæ¡†æ¶ï¼Œå¸¶ä¾†å¤šé …çªç ´æ€§èƒ½åŠ›ï¼š

- **æ›´å¼·å¤§çš„ Suspense**ï¼šé‡å°æ•¸æ“šç²å–ã€ä»£ç¢¼åˆ†å‰²ã€åœ–ç‰‡è¼‰å…¥çš„é€²éšæ”¯æ´
- **Actions èˆ‡ Server Functions**ï¼šèˆ‡ Server Actions æ·±åº¦æ•´åˆ
- **Document Metadata API**ï¼šåŸç”Ÿæ”¯æ´ titleã€meta ç­‰è¨­å®šï¼ŒSEO æ›´ç°¡å–®
- **ä¸¦ç™¼æ¨¡å¼èˆ‡å„ªå…ˆç´šèª¿åº¦**ï¼šUI æ¸²æŸ“å¯ä¸­æ–·ï¼Œå„ªå…ˆè™•ç†é«˜å„ªå…ˆç´šæ›´æ–°

ç›¸æ¯” Next.js 14 ä½¿ç”¨çš„ React 18ï¼Œé€™äº›æ”¹é€²ä½¿å¾—è¤‡é›œæ‡‰ç”¨çš„æ€§èƒ½å’Œç”¨æˆ¶é«”é©—æœ‰äº†è³ªçš„æå‡ã€‚

### 4. Server Actions æ­£å¼ç‰ˆ

Server Actions åœ¨ Next.js 15 æ­£å¼ç©©å®šï¼ŒåŠŸèƒ½æ›´å¼·å¤§ï¼Œå®‰å…¨æ€§æ›´é«˜ï¼š

```tsx
// app/actions.ts - Server Actions åœ¨ Next.js 15 ä¸­çš„å¯«æ³•
'use server';

import { cookies } from 'next/headers';
import { redirect } from 'next/navigation';
import { revalidatePath } from 'next/cache';

// å¼·åŒ–é¡å‹å®‰å…¨
type FormState = {
  error?: string;
  success?: boolean;
};

// æ”¹é€²çš„éŒ¯èª¤è™•ç†å’Œè¡¨å–®é©—è­‰
export async function handleFormSubmission(
  prevState: FormState,
  formData: FormData
): Promise<FormState> {
  try {
    const email = formData.get('email') as string;
    
    if (!email || !email.includes('@')) {
      return { error: 'è«‹æä¾›æœ‰æ•ˆçš„é›»å­éƒµä»¶' };
    }
    
    // è™•ç†è¡¨å–®æäº¤
    await saveToDatabase(email);
    
    // è¨­ç½® cookies
    cookies().set('subscribed', 'true');
    
    // é‡æ–°é©—è­‰é é¢æ•¸æ“š
    revalidatePath('/newsletter');
    
    return { success: true };
  } catch (error) {
    return { error: 'æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦' };
  }
}
```

ç›¸æ¯” Next.js 14 çš„ Server Actionsï¼š
- æ›´å®Œå–„çš„éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
- æ›´å¼·çš„é¡å‹å®‰å…¨æ€§
- èˆ‡ React 19 çš„ useOptimistic æ›´å¥½æ•´åˆ
- æ”¹é€²çš„è¡¨å–®é©—è­‰é«”é©—

### 5. Edge Runtime å¼·åŒ–

Next.js 15 å…¨é¢æ“´å±•äº† Edge Runtime çš„èƒ½åŠ›ï¼š

- **API Routes å…¨é¢æ”¯æ´ Edge**ï¼šæ¯” Node.js ç’°å¢ƒæ›´å¿«çš„å†·å•Ÿå‹•é€Ÿåº¦
- **Middleware åŠŸèƒ½å¢å¼·**ï¼šæ›´å¼·å¤§çš„è«‹æ±‚è™•ç†èƒ½åŠ›ï¼Œä¾‹å¦‚ A/B æ¸¬è©¦ã€åœ°ç†å®šä½ç­‰
- **Edge ä¸Šçš„ Server Actions**ï¼šå‹•æ…‹åŠŸèƒ½ç„¡éœ€å®Œæ•´ Node.js é‹è¡Œæ™‚

```tsx
// app/api/geo/route.ts - Edge API Route ç¯„ä¾‹
import { NextRequest } from 'next/server';

export const runtime = 'edge';

export async function GET(request: NextRequest) {
  const { geo } = request;
  
  // æ ¹æ“šåœ°ç†ä½ç½®æä¾›æœ¬åœ°åŒ–å…§å®¹
  return Response.json({
    country: geo?.country || 'unknown',
    city: geo?.city || 'unknown',
    region: geo?.region || 'unknown',
  });
}
```

Next.js 14 é›–ç„¶æ”¯æ´ Edge Runtimeï¼Œä½† 15 ç‰ˆæœ¬åœ¨ç©©å®šæ€§å’ŒåŠŸèƒ½å»£åº¦ä¸Šæœ‰é¡¯è‘—æå‡ã€‚

### 6. MDX 2.0 åŸç”Ÿæ”¯æ´

Next.js 15 å…§å»º MDX 2.0 æ”¯æ´ï¼Œä¸å†éœ€è¦é¡å¤–é…ç½®ï¼š

- **è‡ªå‹•ç·¨è­¯èˆ‡å„ªåŒ–**ï¼šMDX æ–‡ä»¶è‡ªå‹•è™•ç†ï¼Œéœæ…‹æå–å…ƒæ•¸æ“š
- **React Components èˆ‡ Markdown ç„¡ç¸«èåˆ**ï¼šæ›´è±å¯Œçš„å…§å®¹å±•ç¤º
- **Metadata API æ•´åˆ**ï¼šå¾ MDX å‰ç½®å…ƒæ•¸æ“šè‡ªå‹•ç”Ÿæˆé é¢ metadata

```tsx
// app/blog/[slug]/page.tsx - MDX æ•´åˆç¯„ä¾‹
import { getMDXBySlug, getAllSlugs } from '@/lib/mdx';

// éœæ…‹ç”Ÿæˆæ‰€æœ‰æ–‡ç« è·¯å¾‘
export async function generateStaticParams() {
  const slugs = await getAllSlugs();
  return slugs.map(slug => ({ slug }));
}

// è‡ªå‹•å¾ MDX ç”Ÿæˆé é¢å…ƒæ•¸æ“š
export async function generateMetadata({ params }) {
  const { slug } = params;
  const { meta } = await getMDXBySlug(slug);
  
  return {
    title: meta.title,
    description: meta.description,
    openGraph: {
      images: [meta.image],
    },
  };
}

// æ¸²æŸ“ MDX å…§å®¹
export default async function Post({ params }) {
  const { slug } = params;
  const { content, meta } = await getMDXBySlug(slug);
  
  return (
    <article>
      <h1>{meta.title}</h1>
      <time>{meta.date}</time>
      {content}
    </article>
  );
}
```

ç›¸è¼ƒæ–¼ Next.js 14 éœ€è¦æ‰‹å‹•é…ç½® MDX æ”¯æ´ï¼Œ15 ç‰ˆæœ¬æä¾›äº†æ›´ç„¡ç¸«çš„é«”é©—ã€‚

### 7. æ›´ç°¡æ½”çš„ Metadata API

Next.js 15 æ”¹é€²äº† Metadata APIï¼Œä½¿ SEO å’Œç¤¾äº¤åˆ†äº«è¨­å®šæ›´ç°¡å–®ï¼š

```tsx
// app/layout.tsx - æ”¹é€²çš„ Metadata API

```

Next.js 15 èˆ‡ 14 ç›¸æ¯”ï¼Œå¢åŠ äº†æ›´å¤šå…§ç½®çš„ metadata é¡å‹ï¼Œæå‡äº† SEO å„ªåŒ–é«”é©—ã€‚

## é–‹å§‹ä½¿ç”¨ Next.js 15

### å®‰è£

ç”¨æœ€æ–°ç‰ˆ create-next-app å¿«é€Ÿå»ºç«‹å°ˆæ¡ˆï¼š

```bash
npx create-next-app@latest my-app
```

ç³»çµ±æœƒæç¤ºæ‚¨é€²è¡Œåˆå§‹é…ç½®ï¼š

```
âœ” Would you like to use TypeScript? ... Yes
âœ” Would you like to use ESLint? ... Yes
âœ” Would you like to use Tailwind CSS? ... Yes
âœ” Would you like to use `src/` directory? ... No
âœ” Would you like to use App Router? (recommended) ... Yes
âœ” Would you like to customize the default import alias (@/*)? ... Yes
```

### å°ˆæ¡ˆçµæ§‹

Next.js 15 é¼“å‹µä½¿ç”¨ App Router çµæ§‹ï¼š

```
my-app/
â”œâ”€â”€ app/                  # App Router ä¸»ç›®éŒ„
â”‚   â”œâ”€â”€ layout.tsx        # æ ¹ä½ˆå±€
â”‚   â”œâ”€â”€ page.tsx          # é¦–é 
â”‚   â”œâ”€â”€ about/            # é—œæ–¼é é¢è·¯ç”±
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ blog/             # åšå®¢è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ page.tsx      # åšå®¢åˆ—è¡¨é 
â”‚   â”‚   â””â”€â”€ [slug]/       # å‹•æ…‹åšå®¢æ–‡ç« è·¯ç”±
â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â””â”€â”€ globals.css       # å…¨å±€æ¨£å¼
â”œâ”€â”€ components/           # å…±äº«çµ„ä»¶
â”œâ”€â”€ lib/                  # å·¥å…·å‡½æ•¸å’Œè³‡æ–™è™•ç†
â”œâ”€â”€ public/               # éœæ…‹è³‡æº
â”œâ”€â”€ next.config.js        # Next.js é…ç½®
â”œâ”€â”€ package.json          # ä¾è³´é…ç½®
â””â”€â”€ tailwind.config.js    # Tailwind é…ç½®
```

### Next.js 15 æ ¸å¿ƒé…ç½®é¸é …

ç›¸æ¯” Next.js 14ï¼Œ15 ç‰ˆæœ¬çš„é…ç½®é¸é …æœ‰æ‰€å¢åŠ ï¼š

```js
// next.config.js
/** @type {import('next').NextConfig} */
const nextConfig = {
  // 1. æ–°å¢ï¼šå•Ÿç”¨ PPR (é è¨­ç‚º trueï¼Œå¯ä»¥æ˜ç¢ºè¨­ç½®)
  experimental: {
    ppr: true,
  },
  
  // 2. æ–°å¢ï¼šæŒ‡å®šé è¨­ runtime
  serverComponentsExternalPackages: ['sharp', 'canvas'],
  
  // 3. æ”¹é€²ï¼šåœ–åƒå„ªåŒ–é…ç½®
  images: {
    formats: ['image/avif', 'image/webp'],
    remotePatterns: [
      {
        protocol: 'https',
        hostname: 'images.example.com',
      },
    ],
    minimumCacheTTL: 60,
  },
  
  // 4. æ–°å¢ï¼šTurbopack è‡ªå®šç¾©è¨­å®š
  turbo: {
    resolveAlias: {
      'custom-lib': 'custom-lib/dist',
    },
  },
  
  // 5. æ”¹é€²ï¼šæ›´å¤šç´°ç²’åº¦æ§åˆ¶
  logging: {
    fetches: {
      fullUrl: true,
    },
  },
};

module.exports = nextConfig;
```

## Next.js 15 æœ€ä½³å¯¦è¸

### 1. åˆ©ç”¨ PPR å„ªåŒ–è¼‰å…¥é«”é©—

å€åˆ†éœæ…‹èˆ‡å‹•æ…‹å…§å®¹ï¼Œåˆ©ç”¨ PPR æå‡æ€§èƒ½ï¼š

```tsx
// app/products/page.tsx
import { Suspense } from 'react';
import StaticProductList from './StaticProductList';
import DynamicFilters from './DynamicFilters';
import UserRecommendations from './UserRecommendations';

export default function ProductsPage() {
  return (
    <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
      {/* å´é‚Šæ¬„ï¼šå‹•æ…‹å…§å®¹ */}
      <div>
        <Suspense fallback={<FiltersSkeleton />}>
          <DynamicFilters />
        </Suspense>
      </div>
      
      {/* ä¸»å…§å®¹ï¼šçµåˆéœæ…‹èˆ‡å‹•æ…‹ */}
      <div className="md:col-span-3">
        {/* éœæ…‹ç”¢å“åˆ—è¡¨ */}
        <StaticProductList />
        
        {/* å‹•æ…‹å€‹äººæ¨è–¦ */}
        <section className="mt-8">
          <h2>ç‚ºæ‚¨æ¨è–¦</h2>
          <Suspense fallback={<RecommendationsSkeleton />}>
            <UserRecommendations />
          </Suspense>
        </section>
      </div>
    </div>
  );
}
```

### 2. Server Components èˆ‡ Client Components æ˜ç¢ºåˆ†é›¢

```tsx
// ğŸŸ¢ Server Component (app/dashboard/analytics.tsx)
import { getAnalyticsData } from '@/lib/analytics';

export default async function Analytics() {
  // ç›´æ¥åœ¨æœå‹™å™¨ç«¯ç²å–æ•¸æ“š
  const data = await getAnalyticsData();
  
  return (
    <div className="grid grid-cols-3 gap-4">
      {data.metrics.map(metric => (
        <div key={metric.id} className="p-4 bg-white rounded shadow">
          <h3>{metric.name}</h3>
          <p className="text-2xl font-bold">{metric.value}</p>
        </div>
      ))}
    </div>
  );
}

// ğŸŸ  Client Component (components/interactive/chart.tsx)
'use client';

import { useState } from 'react';
import { LineChart } from '@/components/ui/charts';

export default function InteractiveChart({ initialData }) {
  const [timeRange, setTimeRange] = useState('week');
  
  return (
    <div>
      <div className="flex gap-2 mb-4">
        <button 
          onClick={() => setTimeRange('day')}
          className={`px-3 py-1 rounded ${timeRange === 'day' ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}
        >
          æ—¥
        </button>
        <button 
          onClick={() => setTimeRange('week')}
          className={`px-3 py-1 rounded ${timeRange === 'week' ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}
        >
          é€±
        </button>
        <button 
          onClick={() => setTimeRange('month')}
          className={`px-3 py-1 rounded ${timeRange === 'month' ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}
        >
          æœˆ
        </button>
      </div>
      
      <LineChart data={initialData[timeRange]} />
    </div>
  );
}
```

### 3. ä½¿ç”¨ Server Actions è™•ç†è¡¨å–®

```tsx
// app/contact/actions.ts
'use server';

import { z } from 'zod';
import { redirect } from 'next/navigation';
import { revalidatePath } from 'next/cache';

// è¡¨å–®é©—è­‰æ¨¡å¼
const ContactFormSchema = z.object({
  name: z.string().min(2, 'åç¨±è‡³å°‘éœ€è¦ 2 å€‹å­—ç¬¦'),
  email: z.string().email('è«‹æä¾›æœ‰æ•ˆçš„é›»å­éƒµä»¶'),
  message: z.string().min(10, 'è¨Šæ¯è‡³å°‘éœ€è¦ 10 å€‹å­—ç¬¦'),
});

export async function submitContactForm(prevState, formData) {
  // 1. é©—è­‰è¡¨å–®æ•¸æ“š
  const validatedFields = ContactFormSchema.safeParse({
    name: formData.get('name'),
    email: formData.get('email'),
    message: formData.get('message'),
  });

  // 2. å¦‚æœé©—è­‰å¤±æ•—ï¼Œè¿”å›éŒ¯èª¤
  if (!validatedFields.success) {
    return {
      errors: validatedFields.error.flatten().fieldErrors,
      message: 'è«‹æª¢æŸ¥è¡¨å–®éŒ¯èª¤',
    };
  }

  // 3. æº–å‚™è¦ä¿å­˜çš„æ•¸æ“š
  const { name, email, message } = validatedFields.data;
  
  try {
    // 4. ä¿å­˜åˆ°æ•¸æ“šåº«
    await saveMessageToDatabase({ name, email, message });
    
    // 5. é‡æ–°é©—è­‰è·¯å¾‘
    revalidatePath('/contact');
    
    // 6. è¿”å›æˆåŠŸ
    return {
      message: 'è¨Šæ¯å·²æˆåŠŸé€å‡ºï¼',
    };
  } catch (error) {
    // 7. è™•ç†éŒ¯èª¤
    return {
      message: 'ç™¼é€è¨Šæ¯æ™‚å‡ºéŒ¯ï¼Œè«‹ç¨å¾Œå†è©¦',
    };
  }
}
```

```tsx
// app/contact/page.tsx
'use client';

import { useFormState } from 'react-dom';
import { submitContactForm } from './actions';

const initialState = {
  errors: {},
  message: '',
};

export default function ContactPage() {
  const [state, formAction] = useFormState(submitContactForm, initialState);
  
  return (
    <div className="max-w-md mx-auto p-6 bg-white rounded shadow">
      <h1 className="text-2xl font-bold mb-6">è¯çµ¡æˆ‘å€‘</h1>
      
      {state.message && (
        <div className={`p-3 mb-4 rounded ${state.errors ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800'}`}>
          {state.message}
        </div>
      )}
      
      <form action={formAction}>
        <div className="mb-4">
          <label htmlFor="name" className="block text-sm font-medium mb-1">
            å§“å
          </label>
          <input
            id="name"
            name="name"
            type="text"
            className="w-full px-3 py-2 border rounded"
          />
          {state.errors?.name && (
            <p className="mt-1 text-sm text-red-600">{state.errors.name[0]}</p>
          )}
        </div>
        
        <div className="mb-4">
          <label htmlFor="email" className="block text-sm font-medium mb-1">
            é›»å­éƒµä»¶
          </label>
          <input
            id="email"
            name="email"
            type="email"
            className="w-full px-3 py-2 border rounded"
          />
          {state.errors?.email && (
            <p className="mt-1 text-sm text-red-600">{state.errors.email[0]}</p>
          )}
        </div>
        
        <div className="mb-4">
          <label htmlFor="message" className="block text-sm font-medium mb-1">
            è¨Šæ¯
          </label>
          <textarea
            id="message"
            name="message"
            rows={4}
            className="w-full px-3 py-2 border rounded"
          />
          {state.errors?.message && (
            <p className="mt-1 text-sm text-red-600">{state.errors.message[0]}</p>
          )}
        </div>
        
        <button
          type="submit"
          className="w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700"
        >
          é€å‡º
        </button>
      </form>
    </div>
  );
}
```

### 4. åˆ©ç”¨ Image çµ„ä»¶å„ªåŒ–åœ–ç‰‡è¼‰å…¥

```tsx
// æ¯” Next.js 14 æ›´å¼·å¤§çš„åœ–ç‰‡å„ªåŒ–
import Image from 'next/image';

export default function ProductGallery({ products }) {
  return (
    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
      {products.map(product => (
        <div key={product.id} className="group relative overflow-hidden rounded">
          {/* æ–°å¢ï¼šæ”¯æ´ AVIF æ ¼å¼å’Œæ›´å¤šå±¬æ€§ */}
          <Image
            src={product.image}
            alt={product.name}
            width={400}
            height={300}
            className="object-cover transition-transform group-hover:scale-105"
            sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
            priority={product.featured}
            quality={85}
            placeholder="blur"
            blurDataURL={product.blurDataUrl}
          />
          <div className="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4">
            <h3 className="text-white font-semibold">{product.name}</h3>
            <p className="text-white/80 text-sm">{product.price}</p>
          </div>
        </div>
      ))}
    </div>
  );
}
```

## å¾ Next.js 14 é·ç§»åˆ° 15

å¦‚æœæ‚¨æœ‰ç¾æœ‰çš„ Next.js 14 å°ˆæ¡ˆæƒ³è¦å‡ç´šåˆ° 15 ç‰ˆæœ¬ï¼Œè«‹éµå¾ªä»¥ä¸‹æ­¥é©Ÿï¼š

### 1. æ›´æ–°ä¾è³´

```bash
npm install next@latest react@latest react-dom@latest
```

### 2. èª¿æ•´é…ç½®

æª¢æŸ¥ `next.config.js` ä¸­çš„å¯¦é©—æ€§åŠŸèƒ½ï¼š

```js
const nextConfig = {
  // ç§»é™¤éæ™‚çš„å¯¦é©—æ€§åŠŸèƒ½
  experimental: {
    // appDir å·²å®Œå…¨æ”¯æŒï¼Œä¸å†éœ€è¦
    // appDir: true,
    
    // serverActions å·²æˆç‚ºæ­£å¼åŠŸèƒ½ï¼Œä¸å†éœ€è¦
    // serverActions: true,
    
    // å¦‚éœ€é—œé–‰ PPR (ä¸æ¨è–¦)
    // ppr: false,
  },
};
```

### 3. åˆ©ç”¨ PPR

é‡æ§‹æ‚¨çš„é é¢ä»¥åˆ©ç”¨ PPR åŠŸèƒ½ï¼Œè­˜åˆ¥éœæ…‹å’Œå‹•æ…‹å…§å®¹ï¼š

```tsx
// app/profile/page.tsx
import { Suspense } from 'react';
import ProfileHeader from './ProfileHeader';  // éœæ…‹éƒ¨åˆ†
import UserStats from './UserStats';          // å‹•æ…‹éƒ¨åˆ†
import RecentActivity from './RecentActivity'; // å‹•æ…‹éƒ¨åˆ†

export default function ProfilePage() {
  return (
    <div>
      {/* éœæ…‹éƒ¨åˆ†: ç«‹å³æ¸²æŸ“ */}
      <ProfileHeader />
      
      <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
        {/* å‹•æ…‹éƒ¨åˆ†: ç•°æ­¥åŠ è¼‰ */}
        <Suspense fallback={<div className="h-64 bg-gray-100 animate-pulse rounded"></div>}>
          <UserStats />
        </Suspense>
        
        <Suspense fallback={<div className="h-64 bg-gray-100 animate-pulse rounded"></div>}>
          <RecentActivity />
        </Suspense>
      </div>
    </div>
  );
}
```

### 4. æ›´æ–° Server Actions

å°‡ Server Actions é·ç§»åˆ°æ–°çš„å¯«æ³•ï¼Œåˆ©ç”¨ React 19 çš„æ–°ç‰¹æ€§ï¼š

```tsx
// èˆŠçš„å¯«æ³• (Next.js 14)
'use server';

export async function updateProfile(formData) {
  const name = formData.get('name');
  const bio = formData.get('bio');
  
  await db.user.update({
    where: { id: userId },
    data: { name, bio },
  });
  
  revalidatePath('/profile');
}

// æ–°çš„å¯«æ³• (Next.js 15)
'use server';

import { z } from 'zod';

const UpdateProfileSchema = z.object({
  name: z.string().min(2),
  bio: z.string().max(160),
});

export async function updateProfile(prevState, formData) {
  const rawData = {
    name: formData.get('name'),
    bio: formData.get('bio'),
  };
  
  const validation = UpdateProfileSchema.safeParse(rawData);
  
  if (!validation.success) {
    return {
      status: 'error',
      errors: validation.error.flatten().fieldErrors,
    };
  }
  
  const { name, bio } = validation.data;
  
  try {
    await db.user.update({
      where: { id: userId },
      data: { name, bio },
    });
    
    revalidatePath('/profile');
    
    return {
      status: 'success',
      message: 'å€‹äººè³‡æ–™å·²æ›´æ–°',
    };
  } catch (error) {
    return {
      status: 'error',
      message: 'æ›´æ–°å¤±æ•—',
    };
  }
}
```

## ç¸½çµ

Next.js 15 ä»¥æ›´å¿«çš„é–‹ç™¼é«”é©—ã€æ›´å½ˆæ€§çš„æ¸²æŸ“æ¨¡å¼èˆ‡æ›´å¼·çš„å…¨ç«¯èƒ½åŠ›ï¼ŒæŒçºŒé ˜å…ˆ React ç”Ÿæ…‹åœˆã€‚ä¸»è¦å„ªå‹¢åœ¨æ–¼ï¼š

1. **Partial Prerendering**ï¼šéœæ…‹èˆ‡å‹•æ…‹å…§å®¹çš„å®Œç¾çµåˆï¼Œå¾æ ¹æœ¬ä¸Šæ”¹å–„ä½¿ç”¨è€…é«”é©—
2. **Turbopack ç©©å®šç‰ˆ**ï¼šæ›´å¿«çš„é–‹ç™¼æµç¨‹ï¼Œæ›´é«˜æ•ˆçš„æ§‹å»ºéç¨‹
3. **React 19 æ•´åˆ**ï¼šæœ€æ–° React ç‰¹æ€§çš„å®Œç¾æ”¯æŒ
4. **Server Actions å¢å¼·**ï¼šæ›´å®‰å…¨ã€æ›´ç›´è¦ºçš„ä¼ºæœå™¨ç«¯æ“ä½œ
5. **æ›´ç¾ä»£çš„å·¥å…·éˆ**ï¼šå¾ MDX æ”¯æ´åˆ° Metadata APIï¼Œéƒ½æ›´ç¾ä»£åŒ–ã€æ›´æ˜“ç”¨

ç„¡è«–ä½ æ˜¯è¦æ‰“é€  SaaS ç”¢å“ã€ä¼æ¥­ç¶²ç«™ã€é›»å•†å¹³å°é‚„æ˜¯å…§å®¹å°å‘çš„ç¶²ç«™ï¼ŒNext.js 15 éƒ½èƒ½è®“é–‹ç™¼éç¨‹æ›´æµæš¢ï¼Œä½¿ç”¨è€…é«”é©—æ›´ä½³ã€‚

---

**ç›¸é—œè³‡æºï¼š**
- [Next.js å®˜æ–¹æ–‡æª”](https://nextjs.org/docs)
- [Partial Prerendering å®˜æ–¹èªªæ˜](https://nextjs.org/docs/app/building-your-application/optimizing/partial-prerendering)
- [Server Actions å¯¦ä½œæ•™å­¸](https://nextjs.org/docs/app/building-your-application/data-fetching/server-actions)
- [å¾ Next.js 14 å‡ç´šåˆ° 15](https://nextjs.org/docs/app/building-your-application/upgrading/version-15)
- [React 19 æ–°ç‰¹æ€§ä»‹ç´¹](https://react.dev/blog/2023/03/22/react-labs-what-we-have-been-working-on-march-2023)
- [Vercel éƒ¨ç½²æŒ‡å—](https://vercel.com/docs/frameworks/nextjs)